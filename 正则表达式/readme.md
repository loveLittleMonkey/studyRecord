# 正则的功能
1. 校验数据的有效性
2. 查找符合要求的文本
3. 对文本进行切割和替换 

# 元字符
指那些在正则表达式中具有特殊意义的专用字符
1. 特殊单字符
    * . 任意字符(换行除外)
    * \d 任意数字          \D 任意非数字
    * \w 任意字母数字下划线 \W 任意非字母数字下划线
    * \s 任意空白符        \S 任意非空白符
2. 空白符
    * \r 回车符
    * \n 换行符 Win是 \r\n linux 是 \n
    * \f 换页符
    * \t TAB 制表符
    * \v 垂直制表符
    * \s 任意空白符
3. 范围
    * | 或 如ab|bc 代表 ab或者bc
    * [...] 多选一，口号中任意单个元素
    * [a-z] 匹配a到z之间的任意单个元素(按ascii表，包含a, z)
    * [^...] 取反，不能是括号中的任意单个元素
4. 量词
    * * 0到多次
    * + 1到多次
    * ? 0到1次
    * {m} 出现m次
    * {m,} 出现至少m次
    * {m, n} 出现m到n次
5. 断言
    * () 圆括号是分组



# 贪婪

1. 正则表达式是一个很方便的匹配符号，但要实现这么复杂，功能如此强大的匹配语法，就必须要有一套算法来实现，而实现这套算法的东西就叫做正则表达式引擎。简单地说，实现正则表达式引擎的有两种方式：**DFA 自动机**（Deterministic Final Automata 确定型有穷自动机）和 **NFA 自动机**（Non deterministic Finite Automaton 不确定型有穷自动机）

2. NFA 是以正则表达式为基准去匹配的。也就是说，NFA 自动机会读取正则表达式的一个一个字符，然后拿去和目标字符串匹配，匹配成功就换正则表达式的下一个字符，否则继续和目标字符串的下一个字符比较。

   ```js
   text="Today is a nice day."
   reg="day"
   
   /**
   首先，拿到正则表达式的第一个匹配符：d。于是那去和字符串的字符进行比较，字符串的第一个字符是 T，不匹配，换下一个。第二个是 o，也不匹配，再换下一个。第三个是 d，匹配了，那么就读取正则表达式的第二个字符：a。
   
   读取到正则表达式的第二个匹配符：a。那着继续和字符串的第四个字符 a 比较，又匹配了。那么接着读取正则表达式的第三个字符：y。
   
   读取到正则表达式的第三个匹配符：y。那着继续和字符串的第五个字符 y 比较，又匹配了。尝试读取正则表达式的下一个字符，发现没有了，那么匹配结束。
   */
   ```

3. NFA自动机的回溯

   ```js
   text="abbc"
   reg="ab{1,3}c"
   
   /**
   首先，读取正则表达式第一个匹配符 a 和 字符串第一个字符 a 比较，匹配了。于是读取正则表达式第二个字符。
   
   读取正则表达式第二个匹配符 b{1,3} 和字符串的第二个字符 b 比较，匹配了。但因为 b{1,3} 表示 1-3 个 b 字符串，以及 NFA 自动机的贪婪特性（也就是说要尽可能多地匹配），所以此时并不会再去读取下一个正则表达式的匹配符，而是依旧使用 b{1,3} 和字符串的第三个字符 b 比较，发现还是匹配。于是继续使用 b{1,3} 和字符串的第四个字符 c 比较，发现不匹配了。此时就会发生回溯。
   
   发生回溯是怎么操作呢？发生回溯后，我们已经读取的字符串第四个字符 c 将被吐出去，指针回到第三个字符串的位置。之后，程序读取正则表达式的下一个操作符 c，读取当前指针的下一个字符 c 进行对比，发现匹配。于是读取下一个操作符，但这里已经结束了。
   */
   ```

4. 贪婪模式：尽可能的进行最长的匹配，上述的案例即贪婪模式

5. 非贪婪模式：尽可能的进行最短的匹配，在量词后加上英文的问号(?)

6. 独占模式：类似贪婪匹配，但匹配过程不会发生回溯

* 非贪婪模式中，reg="xy{1,3}?z"; text="xyyz"，尽可能少的匹配。此时匹配了字符串中的xy，正则将用z和字符串中的xy之后的y做比较，发现z和y不匹配，向前回溯，重新查看y匹配两个的情况，匹配上xyy，然后在继续用正则中的z匹配字符串中的z。
* 独占模式中，reg="xy{1,3}+z"; text="xyyz"，y{1,3} 会尽可能长的匹配，匹配完整3个，但是字符串匹配上了z，不符合，匹配结束，没有符合的字符串。[既然如此，直接写xyyyz匹配不就好了？测试一下吧] [js有独占模式嘛]



# 参考文档

[一个正则表达式引发的血案，让线上CPU100%异常！](https://zhuanlan.zhihu.com/p/38229530)

[一个正则表达式引发的血案](https://www.cnblogs.com/study-everyday/p/7426862.html)

